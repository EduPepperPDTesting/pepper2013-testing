<%! from django.utils.translation import ugettext as _ %>
<%!
  from django.core.urlresolvers import reverse
  from courseware.courses import course_image_url, get_course_about_section
  from courseware.access import has_access
  from certificates.models import CertificateStatuses
  from xmodule.modulestore import MONGO_MODULESTORE_TYPE
  from xmodule.modulestore.django import modulestore
  from django.utils import timezone
  from student.models import School,Cohort,District,SubjectArea,GradeLevel,YearsInEducation
  from baseinfo.models import Enum
%>
<!--@begin:Hide Dashboard button in this page-->
<!--@date:2013-11-02-->
<style type="text/css" media="screen">
  #image_uploading{display:none;}
</style>
<!--@end-->
<%inherit file="main.html" />
<%namespace name='static' file='static_content.html'/>
<%block name="title"><title>${_("Dashboard - {username}".format(username=curr_user.username))}</title></%block>
<!--@begin:Add new page style-->
<!--@date:2013-11-02-->
<style type="text/css" media="screen">
 #submit:hover,#submit_email_change:hover,#photo_submit:hover {
   background:#6e8194;
   transition-delay: 0s, 0s, 0s;
   transition-duration: 0.25s, 0.25s, 0.25s;
   transition-property:color, background,​ box-shadow;
   transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1);
   transition-duration:0.25s,​ 0.25s,​ 0.25s;
   color:#fff;
 }
 #submit,#submit_email_change,#photo_submit {
   border-width:0;
   background:#556370;
   text-decoration: none;
   padding-bottom: 7px;
   padding-left: 10px;
   padding-right: 10px;
   padding-top: 7px;
   border-bottom-left-radius: 2px;
   border-bottom-right-radius: 2px;
   cursor: pointer;
   border-top-left-radius: 2px;
   border-top-right-radius: 2px;
   font-family: 'Open Sans',Verdana,Geneva,sans-serif;
   box-shadow: #949494 0px 2px 1px 0px;
   color:#fff;
   transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1);
 }
 .skype-icon{
     background-image: url("/static/images/skype-add.png") !important;
 }
 #create-skype, #create-skype-online {
        float: left;
        margin: 0 20px 0 0;
    }
    .skype-container {
        float: left;
    }
    .skype-button .side-button {
        background: #5A9BD5 url(https://swx.cdn.skype.com/skypewebsdk/shareButton/v/latest/assets/images/s_logo.svg) no-repeat 10px 10px/20px 20px;
        height: 20px;
    }
     .hangout_container {
        text-align: center;
        padding-top: 20px;
    }
    .hangout_container img {
        width: 120px;
        vertical-align: top;
    }
    .hangout_container .side-button {
        background: #8cbe41 url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAQAAAAngNWGAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAJdnBBZwAAABQAAAAUAKM7KtEAAAB2SURBVCjPY/zPQBxgIlIdTRReYfiPFZ5HUsXNMJ/hP24A06P9/8r//4QVpvz/CuHgU8jzfzGCgxvo/b+O4DD+xx3iPxg4iAue38SGoynDZSQeXs9w/p9NjGcgwRPz/zNxChn+a0IC/AoOZVeR4pP7/3zGIZAeAdFoNZxQb6AuAAAAAElFTkSuQmCC) no-repeat 10px 10px;
        height: 20px;
    }
    .side-button {
        color: white !important;
        display: block;
        padding: 10px;
        border-width: 1px;
        border-style: solid;
        text-align: center;
        margin-top: 5px;
    }
    .blue-button {
        border-color: #45719E;
        background: #5A9BD5;
    }
    .green-button {
        border-color: #595;
        background: #8cbe41;
    }
    .red-button {
        border-color: #df0000;
        background: #ED2828;
    }
 .online-circle{
    width: 20px;
    margin-left: 10px;
    margin-top: 2px;
    height: 20px;
    border-radius: 10px;
    position: absolute;
 }
 .online-circle:hover{
     cursor:pointer;
 }
 #submit:normal,,#submit_email_change:normal,#photo_submit:normal {
   background:#126F9A;
   text-decoration: none;
   border-bottom-left-radius: 2px;
   border-bottom-right-radius: 2px;
   cursor: pointer;
   border-top-left-radius: 2px;
   border-top-right-radius: 2px;
   font-family: 'Open Sans',Verdana,Geneva,sans-serif;
   box-shadow: rgb(10, 74, 103) 0px 2px 1px 0px;
   color:#fff;
   transition-timing-function:cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1);
 }
</style>
<!--@end-->
<%block name="js_extra">
<script type="text/javascript">
  /*@begin:Click the round button in grade_level table*/
  /*@date:2013-11-02*/
  function click_grade_btn(i){
    var vals={}
    $.each($("#grade_level_id").val().split(","),function(i,v){
      if(v)vals[v]=1;
    });
    var link=document.getElementById("grade_btn"+i);
    if($(link).hasClass("btn_grade_level_active")){
      $(link).removeClass("btn_grade_level_active");
      vals[i]='';
    }else{
      $(link).addClass("btn_grade_level_active");
      vals[i]=1;
    }
    var arVals=[];
    $.each(vals,function(i,v){
      if(v)arVals.push(i)
    });
    arVals.sort(function(a,b){return parseInt(a)-parseInt(b)});
    $("#grade_level_id").val(arVals.join());
  }
  /*@end*/
  (function() {
    $(".email-settings").click(function(event) {
      $("#email_settings_course_id").val( $(event.target).data("course-id") );
      $("#email_settings_course_number").text( $(event.target).data("course-number") );
      if($(event.target).data("optout") == "False") {
        $("#receive_emails").prop('checked', true);
      }
    });
    $(".unenroll").click(function(event) {
      $("#unenroll_course_id").val( $(event.target).data("course-id") );
      $("#unenroll_course_number").text( $(event.target).data("course-number") );
    });
    $('#unenroll_form').on('ajax:complete', function(event, xhr) {
      if(xhr.status == 200) {
        location.href = "${reverse('dashboard')}";
      } else if (xhr.status == 403) {
        location.href = "${reverse('signin_user')}?course_id=" +
          $("#unenroll_course_id").val() + "&enrollment_action=unenroll";
      } else {
        $('#unenroll_error').html(
          xhr.responseText ? xhr.responseText : "An error occurred. Please try again later."
        ).stop().css("display", "block");
      }
    });
    $('#pwd_reset_button').click(function() {
      $.post('${reverse("password_reset")}',
             {"email"  : $('#id_email').val()},
             function(data){
               //$("#password_reset_complete_link").click();
             });
      return false;
    });
    $("#change_email_form").submit(function(){
      var new_email = $('#new_email_field').val();
      /*@begin:Do not need to confirm passowrd when changing email*/
      /*@date:2013-11-02*/
      //var new_password = $('#new_email_password').val();
      $.post('${reverse("change_email")}',
             {"new_email" : new_email, "password" : ""},
             /*@end*/
             function(data) {
               if (data.success) {
                 $("#change_email_title").html("Please verify your new email");
                 $("#change_email_form").html("<p>You'll receive a confirmation in your " +
                                              "in-box. Please click the link in the " +
                                              "email to confirm the email change.</p>");
                 $("#change_email_form").html("<p>${_('You\'ll receive a confirmation in your in-box. Please click the link in the email to confirm the email change.')}</p>");
               } else {
                 $("#change_email_error").html(data.error).stop().css("display", "block");
               }
             });
      return false;
    });
    $("#change_skype_name_form").submit(function(){
       var username = $("#new_skype_name_field").val();
        $.post('${reverse("change_skype_name")}',
             {"username":username},
             function(data) {
               location.reload();
             });
      return false;
    });
    $("#change_name_form").submit(function(){
      /*@begin:Change the name to two fileds*/
      /*@date:2013-11-02*/
      var new_first_name = $('#new_first_name_field').val();
      var new_last_name = $('#new_last_name_field').val();
      var rationale = $('#name_rationale_field').val();
      $.post('${reverse("change_name")}',
             {"new_first_name":new_first_name, "new_last_name":new_last_name,"rationale":rationale},
             /*@end*/
             function(data) {
               if(data.success) {
                 location.reload();
                 // $("#change_name_body").html("<p>Name changed.</p>");
               } else {
                 $("#change_name_error").html(data.error).stop().css("display", "block");
               }
             });
      return false;
    });
<!--@begin:Process the newly added fields in dashboard-->
<!--@date:2013-11-02-->
    $("#change_school_form").find("select[name='school_id']").val('${curr_user.profile.school_id}')
    $("#change_school_form").submit(function(){
      var school_id = $(this.school_id).val();
      $.post('${reverse("change_school")}',
             {"school_id":school_id},
             function(data) {
               if(data.success) {
                 location.reload();
               } else {
                 $("#change_school_error").html(data.error).stop().css("display", "block");
               }
             });
       return false;
    });
    $.each( '${curr_user.profile.grade_level_id}'.split(',') ,function(i,v){
      if($.trim(v))
        click_grade_btn(v);
    });
    $("#change_grade_level_form").submit(function(){
      var grade_level_id = $(this.grade_level_id).val();
      $.post('${reverse("change_grade_level")}',
             {"grade_level_id":grade_level_id},
             function(data) {
               if(data.success) {
                 location.reload();
               } else {
                 $("#change_grade_level_error").html(data.error).stop().css("display", "block");
               }
             });
      return false;
    });
    // change_percent_lunch submit
    $("#change_percent_lunch_form").find("select[name='percent_lunch']").val('${curr_user.profile.percent_lunch}')
      $("#change_percent_lunch_form").submit(function(){
        var percent_lunch = $(this.percent_lunch).val();
        $.post('${reverse("change_percent_lunch")}',
               {"percent_lunch":percent_lunch},
               function(data) {
                 if(data.success) {
                   location.reload();
                 } else {
                   $("#change_percent_lunch_error").html(data.error).stop().css("display", "block");
                 }
               });
        return false;
      });
    // change_percent_iep submit
    $("#change_percent_iep_form").find("select[name='percent_iep']").val('${curr_user.profile.percent_iep}')
      $("#change_percent_iep_form").submit(function(){
        var percent_iep = $(this.percent_iep).val();
        $.post('${reverse("change_percent_iep")}',
               {"percent_iep":percent_iep},
               function(data) {
                 if(data.success) {
                   location.reload();
                 } else {
                   $("#change_percent_iep_error").html(data.error).stop().css("display", "block");
                 }
               });
        return false;
      });
    // change_percent_eng_learner submit
    $("#change_percent_eng_learner_form").find("select[name='percent_eng_learner']").val('${curr_user.profile.percent_eng_learner}')
      $("#change_percent_eng_learner_form").submit(function(){
        var percent_eng_learner = $(this.percent_eng_learner).val();
        $.post('${reverse("change_percent_eng_learner")}',
               {"percent_eng_learner":percent_eng_learner},
               function(data) {
                 if(data.success) {
                   location.reload();
                 } else {
                   $("#change_percent_eng_learner_error").html(data.error).stop().css("display", "block");
                 }
               });
        return false;
      });
    $("#change_major_subject_area_form").find("select[name='major_subject_area_id']").val('${curr_user.profile.major_subject_area_id}')
      $("#change_major_subject_area_form").submit(function(){
        var major_subject_area_id = $(this.major_subject_area_id).val();
        $.post('${reverse("change_major_subject_area")}',
               {"major_subject_area_id":major_subject_area_id},
               function(data) {
                 if(data.success) {
                   location.reload();
                 } else {
                   $("#change_major_subject_area_error").html(data.error).stop().css("display", "block");
                 }
               });
        return false;
      });
    $("#change_years_in_education_form").find("select[name='years_in_education_id']").val('${curr_user.profile.years_in_education_id}')
      $("#change_years_in_education_form").submit(function(){
        var years_in_education_id = $(this.years_in_education_id).val();
        $.post('${reverse("change_years_in_education")}',
               {"years_in_education_id":years_in_education_id},
               function(data) {
                 if(data.success) {
                   location.reload();
                 } else {
                   $("#change_years_in_education_error").html(data.error).stop().css("display", "block");
                 }
               });
        return false;
      });
    $("#change_bio_form").submit(function(){
      var bio = $(this.bio).val();
      $.post('${reverse("change_bio")}',
             {"bio":bio},
             function(data) {
               if(data.success) {
                 location.reload();
               } else {
                 $("#change_bio_error").html(data.error).stop().css("display", "block");
               }
             });
      return false;
    });
    <!--@end-->
    $("#email_settings_form").submit(function(){
      $.ajax({
        type: "POST",
        url: '${reverse("change_email_settings")}',
        data: $(this).serializeArray(),
        success: function(data) {
          if(data.success) {
            location.href = "${reverse('dashboard')}";
          }
        },
        error: function(xhr, textStatus, error) {
          if (xhr.status == 403) {
            location.href = "${reverse('signin_user')}";          
          }
        }
      });
      return false;
    });
  })(this)
  $("#change_photo_form").submit(function(){
    var AllowImgFileSize=512;
    var AllowImgWidth=1024;
    var AllowImgHeight=768; 
    var fileImg = document.getElementById("id_photo"); 
    <!--check file choose-->
    if (fileImg.value=="")
    {
      $("#change_photo_error").html("Update your avatar by uploading an image from your computer.").stop().css("display", "block");
      fileImg.focus();
      return false;
    }
    <!------------------------------------------>
    <!--check file type-->
    var fileImg_url=fileImg.value.toLowerCase();
    var fileImg_ext=fileImg_url.substring(fileImg_url.length-3,fileImg_url.length);
    if (fileImg_ext!="jpg" && fileImg_ext!="peg" && fileImg_ext!="png")
    {
      $("#change_photo_error").html("We accept image only in JPG or PNG.").stop().css("display", "block");
      //fileImg.select()
      //document.execCommand("Delete");
      fileImg.focus();
      return false;
    }
    <!------------------------------------------>
    <!--check file size(less than 2m)-->
    var file_size =  fileImg.files[0].size;
    if (file_size>2048*1024)
    {
      $("#change_photo_error").html("The file size CANNOT exceed 2MB (2048 KB).").stop().css("display", "block");
      fileImg.focus();
      return false;
    }
    <!------------------------------------------>
    document.getElementById("photo_submit").disabled = true;
    $('#image_uploading').show(); 
    $('#change_photo_form').submit(); 
    });
<!--@begin:clear form content and error information when close the sub page-->
<!--@date:2013-12-05--> 
    $("#change_name_close").click(function(){
      $('#change_name_error').hide();
    });
    $("#change_photo_close").click(function(){
      $('#change_photo_error').hide();
      $('#id_photo')[0].value = "";
    });
    $("#change_bio_close").click(function(){
      $('#id_bio')[0].value = "";
    });
    $("#container_dashboard").click(function(){
      $('#change_name_error').hide();
      $('#change_photo_error').hide();
      $('#id_photo')[0].value = "";
      $('#id_bio')[0].value = "";
    });
<!--@end-->
  //-----------------------------------------------
  $(".portfolio-btn").click(function(){
    var curr_user={};
    var interviewer={};
    //var course_number=$(this).parent().find("a").eq(0).text().split(' ')[0];
    var course_number=$(this).parent().find("a").attr("course_number");
    interviewer.id="${request.user.id}";
    interviewer.name="${request.user.username}";
    interviewer.fullname="${request.user.first_name} ${request.user.last_name}";
    curr_user.id="${curr_user.id}";
    var datainfo={'info':JSON.stringify({'user_id':curr_user.id,'interviewer_id':interviewer.id,'interviewer_name':interviewer.name,
                                         'interviewer_fullname':interviewer.fullname,'type':'view_portfolio',
                                         'course_number':course_number,'date':(new Date()).toISOString(),'activate':'false'})};
    var url = $(this).attr("link");
    $.post("${reverse('save_interactive_update')}",datainfo,function(){window.open(url,'_self');});
   })
  </script>
    <script type="text/javascript" src="https://secure.skypeassets.com/i/scom/js/skype-uri.js"></script>

</%block>
<section class="container dashboard" id="container_dashboard">
  %if message and curr_user==request.user:
    <section class="dashboard-banner">
      ${message}
    </section>
  %endif
  <section class="profile-sidebar">
    <header class="profile">
          <%
          user = curr_user
          active_before = (timezone.now().date() - user.profile.last_activity.date()).days if user.profile.last_activity else 999999
          active_recent = active_before < 1
          %>
      <h1 class="user-name">${ curr_user.username }
          %if active_recent and not curr_user == request.user:
              <img src="/static/images/online-3.png" class="online-circle" id="${curr_user.profile.id}" data-fname="${curr_user.first_name}" data-lname="${curr_user.last_name}" data-skypename="${curr_user.profile.skype_username}"></img>
          %endif
      </h1>
    </header>
    <section class="user-info">
      <ul>
        <li>
<!--@begin:Profile：username-->
<!--@date:2013-11-02-->
          <span class="title">
            <div class="icon name-icon"></div><b>${_("Name")}:</b>
            <span id="full_name_span" class="data" style="display:inline;margin-left:0;font-weight:normal;">${ curr_user.first_name | h } ${ curr_user.last_name | h }</span>
            
			<script>
				var full_name = document.getElementById('full_name_span').textContent;
				if(full_name.length>31)
				{
					document.getElementById('full_name_span').textContent = full_name.substring(0,27)+" ...";
				}
		   </script>
			
			%if curr_user==request.user:
            (<a href="#apply_name_change" rel="leanModal" class="edit-name">${_("edit")}</a>)
            %endif
          </span>
          %if request.user==curr_user:
          <span class="title">
              <div class="icon skype-icon name-icon"></div><b>${_("Skype")}:</b>
            <span id="skype_name_span" class="data" style="display:inline;margin-left:0;font-weight:normal;">${ curr_user.profile.skype_username }</span>

			<script>
				var full_name = document.getElementById('skype_name_span').textContent;
				if(full_name.length>31)
				{
					document.getElementById('skype_name_span').textContent = full_name.substring(0,27)+" ...";
				}
		   </script>
			%if curr_user==request.user:
            (<a href="#apply_skype_name_change" rel="leanModal" class="edit-name">${_("edit")}</a>)
            %endif
          </span>
          %endif
<!--@end-->          
        </li>
<!--@begin:Profile：user photo-->
<!--@date:2013-11-02-->
        <li>
          <span class="title"><div class="icon email-icon" style="background-image:url(/static/images/portal-icons/photo.png) !important;">
            </div><b>${_("User Photo")}</b>
            %if curr_user==request.user:
            (<a href="#change_photo" rel="leanModal" class="edit-photo">${_("edit")}</a>)
            %endif
          </span> 
          <div style="text-align:center;margin-top:5px;">
            <img src="${reverse('user_photo',args=[curr_user.id])}" style="" alt="photo" />
          </div>
        </li>
<!--@end-->
        <!-- <li> -->
        <!--   <span class="title"><div class="icon email-icon"></div>${_("Email")} -->
        <!--     %if curr_user==request.user: -->
        <!--     % if external_auth_map is None or 'shib' not in external_auth_map.external_domain: -->
        <!--     <\!-- (<a href="#change_email" rel="leanModal" class="edit-email">${_("edit")}</a>) -\-> -->
        <!--     % endif -->
        <!--     %endif -->
        <!--   </span> <span class="data">${ curr_user.email | h }</span> -->
        <!-- </li> -->
        %if curr_user==request.user and not request.session.get('idp'):
        % if external_auth_map is None or 'shib' not in external_auth_map.external_domain:
        <li>
          <span class="title"><a href="#password_reset_complete" rel="leanModal" id="pwd_reset_button">${_("Reset Password")}</a></span>
          <form id="password_reset_form" method="post" data-remote="true" action="${reverse('password_reset')}">
            <input id="id_email" type="hidden" name="email" maxlength="75" value="${curr_user.email}" />
            <!-- <input type="submit" id="pwd_reset_button" value="${_('Reset Password')}" /> -->
          </form>
        </li>
        % endif
        %endif
        
<!-------------------------------- My Pepper Stats------------------------------------->
    <li>
      <span class="title">
         <div style="font-family: 'Open Sans';font-size:12px;">
            <div class="" style="padding:0 0 5px 0;"> 
              <b style="font-size:14px;color:#000">My Pepper Stats:</b>
            </div>
            <div style="line-height:30px;"><b>All Course Time:</b>
           <span id="all_course_time" style="display:inline;"></span>
           </div>
           <div style="line-height:30px;"><b>Collaboration Time:</b>
           <span id="collaboration_time" style="display:inline;"></span>
           </div>
           <!-- hide totle adjustment time -->
           <!--
           <div style="line-height:30px;"><b>Adjusted Total Time:</b>
            <span id="totle_adjustment_time" style="display:inline;"></span>
           </div>
           -->
           <div style="line-height:30px;"><b>Total Time:</b>
            <span id="total_time_in_pepper" style="display:inline;"></span>
           </div>
         </div>
      </span>
    </li>
<!-------------------------------------------------------------------------------------->
		<li>
          <span class="title">
		  <div style="font-family: 'Open Sans';font-size:12px;">
            <div class="" style="padding:0 0 5px 0;"> 
              <b style="font-size:14px;color:#000">My Profile:</b>
            </div>
			<div style="line-height:30px;"><b>State:</b>
	          % if curr_user.profile.district_id:
			  ${curr_user.profile.district.state.name}
			  % endif
			</div>
			<div style="line-height:30px;"><b>District:</b>
			  % if curr_user.profile.district_id:
			  <br>${curr_user.profile.district.name}
			  % endif
			</div>
			<div style="line-height:30px;"><b>School:</b>
			  % if curr_user.profile.school_id:
			  <br>${curr_user.profile.school.name}
			  % endif
              %if curr_user==request.user:
			  (<a href="#change_school" rel="leanModal">edit</a>)
              %endif
			</div>
			<div style="line-height:30px;"><b>Grade Level:</b>
              <% gn=list() %>
			  % if curr_user.profile.grade_level_id:
              <br>
			  % for i,c in enumerate(curr_user.profile.grade_level_id.split(',')):
			  % if len(c)>0:
			  <% gn.append(GradeLevel.objects.get(id=c).name) %>
			  % endif
			  % endfor
			  % endif
              ${", ".join(gn)}
              %if curr_user==request.user:
			  (<a href="#change_grade_level" rel="leanModal">edit</a>)
              %endif
			</div>
			<div style="line-height:30px;"><b>Major Subject Area:</b>
			  % if curr_user.profile.major_subject_area_id:
              <br>
			  ${SubjectArea.objects.get(id=curr_user.profile.major_subject_area_id).name}
			  % endif
               %if curr_user==request.user:
			  (<a href="#change_major_subject_area" rel="leanModal">edit</a>)
              %endif
			</div>
			<div style="line-height:30px;"><b>Number of Years in Education:</b>
			  % if curr_user.profile.years_in_education_id:
			  ${YearsInEducation.objects.get(id=curr_user.profile.years_in_education_id).name}
			  % endif
              %if curr_user==request.user:
              (<a href="#change_years_in_education" rel="leanModal">edit</a>)
              %endif
			</div>

            <div style="padding:15px 0 5px 0;"> 
              <b style="font-size:14px;color:#000;">My Learners' Profile:</b>
            </div>
            
			<div style="line-height:30px;">
              <b>Free/Reduced Lunch:</b>
			  % if curr_user.profile.percent_lunch:
			  ${Enum.objects.get(name='percent_lunch',value=curr_user.profile.percent_lunch).content}
			  % endif
              %if curr_user==request.user:
              (<a href="#change_percent_lunch" rel="leanModal">edit</a>)
              %endif
			</div>
            <div style="line-height:30px;">
              <b>IEPs:</b>
			  % if curr_user.profile.percent_iep:
			  ${Enum.objects.get(name='percent_iep',value=curr_user.profile.percent_iep).content}
			  % endif
              %if curr_user==request.user:
              (<a href="#change_percent_iep" rel="leanModal">edit</a>)
              %endif
			</div>
            <div style="line-height:30px;">
              <b>English Learners:</b>
			  % if curr_user.profile.percent_eng_learner:
			  ${Enum.objects.get(name='percent_eng_learner',value=curr_user.profile.percent_eng_learner).content}
			  % endif
              %if curr_user==request.user:
              (<a href="#change_percent_eng_learner" rel="leanModal">edit</a>)
              %endif
			</div>
            </span>
		</li>
        <li>
          <span class="title">
          <div style="font-family: 'Open Sans';font-size:12px;">
            <b style="color:#000;font-size:14px;">Bio:</b>
            %if curr_user==request.user:
            (<a href="#change_bio" rel="leanModal">edit</a>)
            %endif
<pre style="padding:0;margin-top:10px;">
%if curr_user.profile.bio:
${curr_user.profile.bio}
%else:
Add info that you would like to share about yourself here:  
%endif
</pre>
          </div>
          </span>
        </li>
<!--@end-->        
      </ul>
<!--@begin: Remove some profile info-->
<!--@date:2013-11-02-->  
         <!-- <div style="width:180px">  <span>City:Aptos</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:180px"><span>State:Ca</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:180px"><span>Zip:96003</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:180px"><span>Address:(none)</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:180px"><span>Phone:(none)</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div><p/></div> -->
         <!-- <div style="width:180px"><span>District:Really big</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:220px"><span>School:Ver Little School</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:240px"><span>Role tale in school:Teacher</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
         <!-- <div style="width:230px"><span>Focus Grade(s)4,5,and 6</span>  <span style="float:right;padding-right:0px;">(<a href="" class="">edit</a>)</span></div> -->
       </div>
<!--@end-->      
    </section>
  </section>
<!--@begin:The styles used only in Dashboard-->
<!--@date:2013-11-02-->
<style type="text/css" media="screen">
  a.btnx:hover {
  background: linear-gradient(#1e8bbe, #0e72a1); 
  transition-delay: 0s, 0s, 0s;
  transition-duration: 0.25s, 0.25s, 0.25s;
  transition-property:color, background,​ box-shadow;
  transition-timing-function:
  cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1);
  transition-duration:0.25s,​ 0.25s,​ 0.25s;
  text-decoration:none;
  }
  a.btnx {
  background-clip: padding-box;
  border:1ps solid rgb(13, 114, 162);
  background-color:rgb(29, 157, 217);
  background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #1d9dd9), color-stop(100%, #0e7cb0));
  background-image: -webkit-linear-gradient(#1d9dd9, #0e7cb0);
  background-image: linear-gradient(#1d9dd9, #0e7cb0);
  border: 1px solid #0d72a2;
  box-shadow: inset 0 1px 0 0 #61b8e1;
  text-decoration: none;
  padding:6px 32px 7px 32px;
  line-height:26px;
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  border-top-left-radius: 3px;
  border-top-right-radius: 3px;
  cursor: pointer;
  font-family: 'Open Sans',Verdana,Geneva,sans-serif;
  color:#fff;
  transition-timing-function: cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1);
  }
  a.btnx:normal {
  background-color:#126F9A;
  text-decoration: none;
  border-bottom-left-radius: 2px;
  border-bottom-right-radius: 2px;
  cursor: pointer;
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
  font-family: 'Open Sans',Verdana,Geneva,sans-serif;
  color:#fff;
  transition-timing-function:cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.42, 0, 0.58, 1);
  }
</style>
<!--@end-->
<!--@begin:Add lastnew in Dashboard-->
<!--@date:2013-11-02-->
<section class="my-courses">
  <header style="width:886px;height:246px;margin:auto;position:relative;border-bottom:none;margin-bottom:30px;">
    <div style="position:absolute;background:url(${static.url('images/p15.png')});width:886px;height:246px;">
      <a href="http://www.pepperpcg.blogspot.com" target="_blank" style="margin:170px 0 0 227px;position:absolute;" class="btnx dashboard-btn1">${_('Latest News')}</a>
    </div>
  </header>
</section>
<!--@end-->

<!--@begin:Add alert in Dashboard page-->
<!--@date:2016-04-12-->
%if alert_enabled == "enabled" and alert_text != "":
<section class="my-courses">
<div id="con_alert" style="width:879px;margin:auto;position:relative;margin-bottom:30px;border:2px solid #900;">
  <div style="width:829px;background-color:#FFC651;font-weight:bold;color:#900;padding:25px;line-height:20px;">
      ${alert_text}
  </div>
</div>
</section>
%endif
<!--@end-->

% if curr_user==request.user:
% if havent_enroll > 0:
<section class="my-courses" style="padding:20px 0 20px 0;text-align:right;" >
  <a href="/more_courses_available" class="btnx dashboard-btn1">
    ${havent_enroll} More Course(s) Available For You
  </a>
</section>
% endif
% endif


<section class="my-courses" style="" >
  <header>
    <h2>${_("External Courses")}</h2>
  </header>

  <article class="my-course" style="border-bottom:3px solid #0098C9">
    <a href="/sso/idp/auth/?sp=edu2000" class="cover" target="_blank">
      <img src="/static/images/realgebra_icon.png" style="width:200px;height:135px;" alt="PEP101x User’s Guide to Pepper Cover Image">
    </a>
    <section class="info">
      <hgroup>
        <p class="date-block"></p>
        <h2 class="university">Edu2000</h2>
        <h3><a href="/sso/idp/auth/?sp=edu2000" target="_blank">Realgebra</a></h3>
      </hgroup>
      <link rel="stylesheet" href="/static/tmp-resource/css/main.css" type="text/css" media="screen">
      <a href="/sso/idp/auth/?sp=edu2000" target="_blank" class="enter-course dashboard-btn2">View Course</a>
      <div class="course-time" time_type="course" course_id="PCG/PEP101x/2014_Spring"></div>
    </section>
  </article>
</section>

<section class="my-courses" style="" >
    <header>
      <h2>${_("Current Courses")}</h2>
    </header>

    % if len(courses_incomplated) > 0:
<!--@begin:Change the disply of the courses list in Dashboard-->
<!--@date:2013-11-02-->    
      % for i,course in enumerate(courses_incomplated):
    <%
       border_overide='';
       if i==len(courses_incomplated)-1:
         border_overide="border-bottom:3px solid #0098C9"
       %>
        <article class="my-course" style="${border_overide}" >
          <%
            course_target = reverse('courseware', args=[course.id])
          %>
          % if course.id in show_courseware_links_for:
          %if curr_user==request.user:
            <a href="${course_target}" class="cover">
          %else:
            <a href="" class="cover" style="cursor:default;" onclick="return false;">
          %endif
              <img src="${course_image_url(course)}" style="width:200px;height:104px;" alt="${_('{course_number} {course_name} Cover Image').format(course_number=course.number, course_name=course.display_name_with_default) |h}" />
            </a>
<!--@end-->          
            % else:
            <div class="cover">
              <img src="${course_image_url(course)}" alt="${_('{course_number} {course_name} Cover Image').format(course_number=course.number, course_name=course.display_name_with_default) | h}" />
            </div>
          % endif
          <section class="info">
            <hgroup>
<!--@begin:Change the display of current courses in Dashboard-->
<!--@date:2013-11-02-->                 
              <p class="date-block">
                ${_("Enrollment date - {end_date:%B %d,%Y}").format(end_date=course.student_enrollment_date)}
                %if curr_user==request.user:
                  <a href="#unenroll-modal" class="unenroll" style="font-size:13px;margin:2px 0px 0px 10px" rel="leanModal" data-course-id="${course.id}" data-course-number="${course.number}">${_('Unregister')}</a>
                %endif
              </p>
              % if False:
              <p class="date-block">
              % if course.has_ended():
              ${_("Course Completed - {end_date}").format(end_date=course.end_date_text)}
              % elif course.has_started():
              ${_("Course Started - {start_date}").format(start_date=course.start_date_text)}
              % else:   # hasn't started yet
              ${_("Course Starts - {start_date}").format(start_date=course.start_date_text)}
              % endif
              </p>
              % endif
<!--@end-->      
              <h2 class="university">${get_course_about_section(course, 'university')}</h2>
              <h3>
                % if course.id in show_courseware_links_for:
                %if curr_user==request.user:
                  <a href="${course_target}">${course.display_number_with_default | h} ${course.display_name_with_default}</a>
                %else:
                  <a href="" style="cursor:default;" onclick="return false;" course_number="${course.display_number_with_default | h}">${course.display_number_with_default | h} ${course.display_name_with_default}</a>
                %endif
                % else:
                  <span>${course.display_number_with_default | h} ${course.display_name_with_default}</span>
                % endif
              </h3>
            </hgroup>
            <%
                testcenter_exam_info = course.current_test_center_exam
                registration = exam_registrations.get(course.id)
                testcenter_register_target = reverse('begin_exam_registration', args=[course.id])
            %>
            % if testcenter_exam_info is not None:
                % if registration is None and testcenter_exam_info.is_registering():
                <div class="message message-status is-shown exam-register">
                  <a href="${testcenter_register_target}" class="button exam-button" id="exam_register_button">${_("Register for Pearson exam")}</a>
                  <p class="message-copy">${_("Registration for the Pearson exam is now open and will close on {end_date}").format(end_date="<strong>{}</strong>".format(testcenter_exam_info.registration_end_date_text))}</p>
                </div>
                % endif
                <!-- display a registration for a current exam, even if the registration period is over -->
                % if registration is not None:
                    % if registration.is_accepted:
                <div class="message message-status is-shown exam-schedule">
                   <a href="${registration.registration_signup_url}" class="button exam-button">${_("Schedule Pearson exam")}</a>
                   <p class="exam-registration-number">${_("{link_start}Registration{link_end} number: {number}").format(
                      link_start='<a href="{url}" id="exam_register_link">'.format(url=testcenter_register_target),
                      link_end='</a>',
                      number=registration.client_candidate_id,
                    )}</p>
                   <p class="message-copy">${_("Write this down! You'll need it to schedule your exam.")}</p>
                </div>
                    % endif
                    % if  registration.is_rejected:
                <div class="message message-status is-shown exam-schedule">
                  <p class="message-copy">
                    <strong>${_("Your registration for the Pearson exam has been rejected. Please {link_start}see your registration status details{link_end}.").format(
                      link_start='<a href="{url}" id="exam_register_link">'.format(url=testcenter_register_target),
                      link_end='</a>')}</strong>
                    ${_("Otherwise {link_start}contact edX at {email}{link_end} for further help.").format(
                      link_start='<a class="contact-link" href="mailto:{email}?subject=Pearson VUE Exam - {about} {number}">'.format(email="exam-help@edx.org", about=get_course_about_section(course, 'university'), number=course.display_number_with_default),
                      link_end='</a>',
                      email="exam-help@edx.org",
                     )}
                </div>
                    % endif
                   	% if not registration.is_accepted and not registration.is_rejected:
	            <div class="message message-status is-shown">
                  <p class="message-copy"><strong>${_("Your {link_start}registration for the Pearson exam{link_end} is pending.").format(link_start='<a href="{url}" id="exam_register_link">'.format(url=testcenter_register_target), link_end='</a>')}</strong>
                  ${_("Within a few days, you should see a confirmation number here, which can be used to schedule your exam.")}
                  </p>
                </div>
                    % endif
                % endif
            % endif
            <%
            cert_status = cert_statuses.get(course.id)
            %>
            % if course.has_ended() and cert_status:
                <%
                if cert_status['status'] == 'generating':
                    status_css_class = 'course-status-certrendering'
                elif cert_status['status'] == 'ready':
                    status_css_class = 'course-status-certavailable'
                elif cert_status['status'] == 'notpassing':
                    status_css_class = 'course-status-certnotavailable'
                else:
                    status_css_class = 'course-status-processing'
                %>
                <div class="message message-status ${status_css_class} is-shown">
                % if cert_status['status'] == 'processing':
                      <p class="message-copy">${_("Final course details are being wrapped up at this time. Your final standing will be available shortly.")}</p>
                % elif cert_status['status'] in ('generating', 'ready', 'notpassing', 'restricted'):
                      <p class="message-copy">${_("Your final grade:")}
                      <span class="grade-value">${"{0:.0f}%".format(float(cert_status['grade'])*100)}</span>.
                      % if cert_status['status'] == 'notpassing':
                         ${_("Grade required for a certificate:")} <span class="grade-value">
                           ${"{0:.0f}%".format(float(course.lowest_passing_grade)*100)}</span>.
                      % elif cert_status['status'] == 'restricted':
                          <p class="message-copy">
                          ${_("Your certificate is being held pending confirmation that the issuance of your certificate is in compliance with strict U.S. embargoes on Iran, Cuba, Syria and Sudan. If you think our system has mistakenly identified you as being connected with one of those countries, please let us know by contacting {email}.").format(email='<a class="contact-link" href="mailto:{email}">{email}</a>.'.format(email=settings.CONTACT_EMAIL))}
                          </p>
                      % endif
                      </p>
                % endif
                % if cert_status['show_disabled_download_button'] or cert_status['show_download_url'] or cert_status['show_survey_button']:
                  <ul class="actions">
                    % if cert_status['show_disabled_download_button']:
                      <li class="action"><span class="disabled">
                          ${_("Your Certificate is Generating")}</span></li>
                    % elif cert_status['show_download_url']:
                      <li class="action">
                      <a class="btn" href="${cert_status['download_url']}"
                         title="${_('This link will open/download a PDF document')}">
                         Download Your PDF Certificate</a></li>
                    % endif
                    % if cert_status['show_survey_button']:
                      <li class="action"><a class="cta" href="${cert_status['survey_url']}">
                             ${_('Complete our course feedback survey')}</a></li>
                    % endif
                  </ul>
                % endif
                </div>
            % endif
            <link rel="stylesheet" href="/static/tmp-resource/css/main.css" type="text/css" media="screen" />
            % if course.id in show_courseware_links_for:
      		%if curr_user==request.user:              
			<a href="${reverse('portfolio_about_me',args=[course.id])}" class="enter-course dashboard-btn1">${_('View Portfolio')}</a>
			%else:
            <a href="javascript:void(0)" class="enter-course dashboard-btn1 portfolio-btn" link="${reverse('portfolio_about_me',args=[course.id,curr_user.id])}">${_('View Portfolio')}</a>
            %endif
            %if curr_user==request.user:      
            <a href="${course_target}" class="enter-course dashboard-btn2" style="margin-left:10px;">${_('View Course')}</a>
            %endif
            % endif
            %if curr_user==request.user:
	    % if settings.MITX_FEATURES['ENABLE_INSTRUCTOR_EMAIL'] and modulestore().get_modulestore_type(course.id) == MONGO_MODULESTORE_TYPE:
	      <!-- Only show the Email Settings link/modal if this course has bulk email feature enabled -->
               <!-- hide email settings -->
              <!--
              <a href="#email-settings-modal" class="email-settings" rel="leanModal" data-course-id="${course.id}" data-course-number="${course.number}" data-optout="${course.id in course_optouts}">${_('Email Settings')}</a>
              -->
              % if course.hide_timer == False:
                % if course.show_external_timer == False:
                  <div class="course-time" time_type="course" course_id="${course.id}">Course Time: <span></span></div>
                % else:
                  <div class="course-time" time_type="external" course_id="${course.id}">External Time: <span></span></div>
                % endif
              % endif
	    % endif
           %endif
          </section>
        </article>
      % endfor
    % else:
      <section class="empty-dashboard-message">
        %if curr_user==request.user:
        <p>${_("Looks like you haven't registered for any courses yet.")}</p>
        <a href="${marketing_link('COURSES')}">
            ${_("Find courses now!")}
        </a>
        %endif
      </section>
    % endif
    % if staff_access and len(errored_courses) > 0:
      <div id="course-errors">
        <h2>${_("Course-loading errors")}</h2>
      % for course_dir, errors in errored_courses.items():
         <h3>${course_dir | h}</h3>
             <ul>
           % for (msg, err) in errors:
               <li>${msg}
                 <ul><li><pre>${err}</pre></li></ul>
               </li>
           % endfor
             </ul>
      % endfor
    % endif
<!--@begin:Shown completed course list-->
<!--@date:2013-11-02-->
          <header>
            <h2>${_("Completed Courses")}</h2>
          </header>
          <%include file="completed_courses.html" />
<!--@end-->
</section>
</section>
<!--@begin:Chagne the table with new profile fields-->
<!--@date:2013-11-02-->
<section id="change_photo" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Add Profile Picture').format(course_number='<span id="email_settings_course_number"></span>')}</h2>
      <hr/>
    </header>
    <form id="change_photo_form" method="post" enctype="multipart/form-data" action="upload_photo">
      <!--@begin:Shown completed course list-->
      <!--@date:2013-11-24-->
      <div id="change_photo_error" class="modal-form-error"> </div>
      <!--@end-->
      <fieldset>
        <div class="input-group">
          <label>
            <div style="border:5px solid #999;width:110px;height:110px;text-align:center;">
              <img src="${reverse('user_photo')}" style="" alt="photo" />
            </div>
          </label>
          <label style="margin:20px 0;display:block;">
            <input type="file" name="photo" id="id_photo" value="Choose a file" />
          </label>
          <label>
            The image will be automatically scaled to fit within 110x110 pixels.
          </label>  
          <div id="image_uploading" style="text-align:center;">
            <img src="/static/images/ora-loading.gif" style=""/> 
          </div>              
        </div>
      </fieldset>
	  <input type="hidden" name="csrfmiddlewaretoken" value="${csrf_token}"/>
      <div class="submit">
        <input type="submit" class="btnx" id="photo_submit" value="Upload" />
      </div>          
    </form>
    <div class="close-modal" id="change_photo_close">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="change_school" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change My School').format(course_number='<span id="email_settings_course_number"></span>')}</h2>
      <hr/>
    </header>
    <form id="change_school_form" method="post">
      <fieldset>
        <div class="input-group">
            <label>School:</label>
            <label style="margin:20px 0;display:block;">
              <select name="school_id" style="width:100%" autocomplete="off">
              	% if curr_user.profile.district_id:
                %for item in School.objects.filter(district_id=curr_user.profile.district.id).order_by("name"):
                <option value="${item.id}">${item.name}</option>
                %endfor
              	% endif
              </select>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<link rel="stylesheet" href="/static/tmp-resource/css/main.css" type="text/css" media="screen" />
<section id="change_grade_level" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change My Grade Level').format(course_number='<span id="email_settings_course_number"></span>')}</h2>
      <hr/>
    </header>
    <form id="change_grade_level_form" method="post">
      <fieldset>
        <label id="">
          Grade Level-Check all that apply:
        </label>
        <div class="input-group">
          <label style="margin:20px 0;display:block;">
            <input id="grade_level_id" type="hidden" name="grade_level_id" value="" autocomplete="off"/>
            %for item in GradeLevel.objects.all():
            <span class="level">
              <a href="#" id="grade_btn${item.id}" class="btn_grade_level" onclick="click_grade_btn(${item.id});return false">
                ${item.name}
              </a>
            </span>
            %endfor
            <br style="clear:both;"/>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="change_major_subject_area" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change My Subject Area').format(course_number='<span id="email_settings_course_number"></span>')}</h2>
      <hr/>
    </header>
    <form id="change_major_subject_area_form" method="post">
      <fieldset>
        <div class="input-group">
          <label style="margin:20px 0;display:block;">
            <select id="major_subject_area_id" name="major_subject_area_id" style="width:100%" autocomplete="off">
              %for item in SubjectArea.objects.all().order_by('so'):
              <option value="${item.id}">${item.name}</option>
              %endfor
            </select>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="change_years_in_education" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change Number of Years in Education').format()}</h2>
      <hr/>
    </header>
    <form id="change_years_in_education_form" method="post">
      <fieldset>
        <div class="input-group">
          <label style="margin:20px 0;display:block;">
            <select id="years_in_education_id" name="years_in_education_id" style="width:100%" autocomplete="off">
              %for item in YearsInEducation.objects.all():
              <option value="${item.id}">${item.name}</option>
              %endfor
            </select>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<!-- percent_lunch form -->
<section id="change_percent_lunch" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change Free/Reduced Lunch').format()}</h2>
      <hr/>
    </header>
    <form id="change_percent_lunch_form" method="post">
      <fieldset>
        <div class="input-group">
          <label style="margin:20px 0;display:block;">
            <select id="percent_lunch" name="percent_lunch" style="width:100%" autocomplete="off">
              %for item in Enum.objects.filter(name="percent_lunch").order_by("odr"):
              <option value="${item.value}">${item.content}</option>
              %endfor
            </select>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<!-- change_percent_iep form -->
<section id="change_percent_iep" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change IEPs').format()}</h2>
      <hr/>
    </header>
    <form id="change_percent_iep_form" method="post">
      <fieldset>
        <div class="input-group">
          <label style="margin:20px 0;display:block;">
            <select id="percent_iep" name="percent_iep" style="width:100%" autocomplete="off">
              %for item in Enum.objects.filter(name="percent_iep").order_by("odr"):
              <option value="${item.value}">${item.content}</option>
              %endfor
            </select>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<!-- percent_eng_learner form -->
<section id="change_percent_eng_learner" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change English Learners').format()}</h2>
      <hr/>
    </header>
    <form id="change_percent_eng_learner_form" method="post">
      <fieldset>
        <div class="input-group">
          <label style="margin:20px 0;display:block;">
            <select id="percent_eng_learner" name="percent_eng_learner" style="width:100%" autocomplete="off">
              %for item in Enum.objects.filter(name="percent_lunch").order_by("odr"):
              <option value="${item.value}">${item.content}</option>
              %endfor
            </select>
          </label>
        </div>
      </fieldset>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="change_bio" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Change My BIO').format(course_number='<span id="email_settings_course_number"></span>')}</h2>
      <hr/>
    </header>
    <form id="change_bio_form" method="post">
      <fieldset>
        <div class="input-group">
          <label>
            <textarea maxlength="255" id="txBio" name="bio" rows="" cols="" tabindex=""  style="width:100%;height:100%;height:300px;resize:none;">${curr_user.profile.bio}</textarea>
          </label>
          <section style="color:black;">
            Maximum to 255 Characters <span></span>
          </section>
        </div>
      </fieldset>
      <script type="text/javascript">
        var txBio=document.getElementById('txBio');
        txBio.oninput=function(){
          $(this).parent().next("section").find("span").html(255-this.value.length)
        }
        txBio.oninput()
      </script>
      <div class="submit">
        <input type="submit" class="btnx" id="submit" value="Save Changes" />
      </div>          
    </form>
    <div class="close-modal">
      <div class="inner" id="change_bio_close">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
  <!--@end-->
</section>
<section id="email-settings-modal" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Email Settings for {course_number}').format(course_number='<span id="email_settings_course_number"></span>')}</h2>
      <hr/>
    </header>
    <form id="email_settings_form" method="post">
      <input name="course_id" id="email_settings_course_id" type="hidden" />
      <label>${_("Receive course emails")} <input type="checkbox" id="receive_emails" name="receive_emails" /></label>
      <div class="submit">
<!--@begin:Chagne the button bolor in Email Settings table-->
<!--@date:2013-11-02-->
        <input type="submit" class="btnx" id="submit" value="Save Settings" />
<!--@end-->        
      </div>
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="unenroll-modal" class="modal unenroll-modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Are you sure you want to unregister from {course_number}?').format(course_number='<span id="unenroll_course_number"></span>')}</h2>
      <hr/>
    </header>
    <div id="unenroll_error" class="modal-form-error"></div>
    <form id="unenroll_form" method="post" data-remote="true" action="${reverse('change_enrollment')}">
      <input name="course_id" id="unenroll_course_id" type="hidden" />
      <input name="enrollment_action" type="hidden" value="unenroll" />
      <div class="submit">
        <input id="submit" name="submit" type="submit" value="Unregister" />
      </div>
    </form>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="password_reset_complete" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_('Password Reset Email Sent')}</h2>
      <hr/>
    </header>
    <div>
      <form> <!-- Here for styling reasons -->
        <section>
          <p>${_('An email has been sent to {email}. Follow the link in the email to change your password.').format(email=curr_user.email)}</p>
        </section>
      </form>
    </div>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<section id="change_email" class="modal">
  <div class="inner-wrapper">
    <header>
<!--@begin:Change the title of email table-->
<!--@date:2013-11-02-->            
      <h2><span id="change_email_title">${_("Change My Email")}</span></h2>
<!--@end-->
      <hr/>
    </header>
    <div id="change_email_body">
      <form id="change_email_form">
        <div id="change_email_error" class="modal-form-error"> </div>
        <fieldset>
          <div class="input-group">
<!--@begin:Change the email table-->
<!--@date:2013-11-02-->            
            <label>${_('Please edit your email below:')}</label>
            <input id="new_email_field" type="email" value="${curr_user.email}" />
            <!-- <label>${_('Please confirm your password:')}</label> -->
            <!-- <input id="new_email_password" value="" type="password" /> -->
          </div>
          <!-- <section> -->
          <!--   <p>${_('We will send a confirmation to both {email} and your new email as part of the process.').format(email=curr_user.email)}</p> -->
          <!-- </section> -->
<!--@end-->          
          <div class="submit">
            <input type="submit" id="submit_email_change" value="${_('Change Email')}"/>
          </div>
        </fieldset>
      </form>
    </div>
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<!--@begin:User photo upload table-->
<!--@date:2013-11-02-->
<!----
<section id="apply_picture_change" class="modal">
  <div class="inner-wrapper">
    <div class="close-modal">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
    <header>
      <h2>Picture uploading</h2>
      <hr/>
    </header>
    <div id="">
      <form method="" id="" action="">
       <fieldset>
          <div class="input-group">
            <label>Please choose a file.</label>
            <input type="file" name="file" value="" />
          </div>
          <div class="submit">
            <input type="submit" id="submit" value="Upload now">
          </div>
        </fieldset>
      </form>
    </div>
  </div>
</section>
-->
<!--@end-->
<section id="apply_name_change" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_("Change your name")}</h2>
      <hr/>
    </header>
    <div id="change_name_body">
      <form id="change_name_form">
        <div id="change_name_error" class="modal-form-error"> </div>
        <p>${_("To uphold the credibility of {platform} certificates, all name changes will be logged and recorded.").format(platform=settings.PLATFORM_NAME)}</p>
        <br/>
        <fieldset>
          <div class="input-group">
            <label>${_("Enter your desired full name, as it will appear on the {platform} certificates:").format(platform=settings.PLATFORM_NAME)}</label>
<!--@begin:Username change table-->
<!--@date:2013-11-02-->            
            <br/><br/>
            <label style="font-style:normal;color:#666;font-size:16px;font-family:'open sans'">First Name</label>
            <input id="new_first_name_field" value="${curr_user.first_name}" type="text" autocomplete="off" maxlength="30"/>
            <label style="font-style:normal;color:#666;font-size:16px;font-family:'open sans'">Last Name</label>
            <input id="new_last_name_field" value="${curr_user.last_name}" type="text" autocomplete="off" maxlength="30"/>
<!--@end-->
            <label>${_("Reason for name change:")}</label>
            <textarea id="name_rationale_field" value=""></textarea>
          </div>
          <div class="submit">
            <input type="submit" id="submit" value="${_('Change My Name')}">
          </div>
        </fieldset>
      </form>
    </div>
    <div class="close-modal" id="change_name_close">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>

<section id="apply_skype_name_change" class="modal">
  <div class="inner-wrapper">
    <header>
      <h2>${_("Update your Skype Username")}</h2>
      <hr/>
    </header>
    <div id="change_name_body">
      <form id="change_skype_name_form">
        <div id="change_skype_name_error" class="modal-form-error"> </div>
        <fieldset>
          <div class="input-group">
            <label>${_("Enter your Skype Username.")}</label>
<!--@begin:Username change table-->
<!--@date:2013-11-02-->
            <br/><br/>
            <label style="font-style:normal;color:#666;font-size:16px;font-family:'open sans'">Skype Username</label>
            <input id="new_skype_name_field" value="${curr_user.profile.skype_username}" type="text" autocomplete="off" maxlength="255"/>
<!--@end-->
          </div>
          <div class="submit">
            <input type="submit" id="submit" value="${_('Update Skype Username')}">
          </div>
        </fieldset>
      </form>
    </div>
    <div class="close-modal" id="change_name_close">
      <div class="inner">
        <p>&#10005;</p>
      </div>
    </div>
  </div>
</section>
<div style="" id="skype-dialog-online" class="modal">
    <div class="inner-wrapper" style="border:0;border-radius:5px;padding:0">
        <div class="titlebar">
            <h3 class="dialog-title">Start Skype Call</h3>
            <div class="close-modal" id="dialog_close">✕</div>
        </div>
        <div class="content">
            <form>
                <label id="skype-name-exists">Begin a call with: .</label><span id="skype-online-name"></span><br>
                <span id ="skype-name-exists-toggle"><label>Topic (optional):<input type="text" name="skype-topic"></label>
                <input type="button" value="Create" id="create-skype-online">
                <div class="skype-container-online">
                    <script type="text/javascript">
                        function startSkypeOnline(params) {
                            var skype_button_online = Skype.ui(params);
                            if (skype_button_online) {
                                var id = $('.skype-container-online').attr('id');
                                $('#' + id + '_paraElement img').css({'margin': '0', 'vertical-align': '0'});
                            }
                        }
                    </script>
                </div>
                </span>
            </form>
            <div class="community-clear"></div>
        </div>
    </div>
</div>
<div style="" id="online_dialog" class="modal">
  <div class="inner-wrapper" style="border:0;border-radius:5px;padding:0">
    <div class="titlebar">
      <h3 style="padding:20px;display:block;text-align:center;" id="dlg-name-title"></h3>
      <div class="close-modal" id="dialog_close">✕</div>
    </div>
    <div style="color:#000;text-align:center;padding:10px;">
      <img src="" class="" alt="" id="dlg-user-photo" width="230"/><br/>
      <div style="display:inline-block;vertical-align:bottom;">
        <img src="/static/images/community_google_hangouts.png" class="" alt="" /><br/>
        <a href="https://plus.google.com/hangouts/_/aqd2g5oysfdkvdova5mt5qmqaae" target="_blank" class="green-button side-button hangout-button">Join Hangout</a>
      </div>
      <div style="display:inline-block;vertical-align:bottom;">
        <img src="/static/images/online/skype.jpg" class="" alt="" /><br>
        <a href="#" id="skype-start-online" class="side-button blue-button skype-button">Start Skype Call</a>
      </div>
    </div>
  </div>
</div>
<script>
    $(document).ready(function(){
       $(".online-circle").click(function(event){
            event.preventDefault();
            scroll(0,0);
            $("#skype-online-name").text("");
            $("#dlg-name-title").html($(this).attr("data-fname")+" "+$(this).attr("data-lname"));
            $("#dlg-user-photo").attr("src", "/user_photo/"+$(this).attr("id"));
            if($(this).attr("data-skypename") == "None"){
                $("#skype-name-exists").text("This user does not have their skype name set.");
                $("#skype-name-exists-toggle").hide();
            }else{
                $("#skype-online-name").text($(this).attr("data-skypename"));
            }
            main_dlg=new Dialog($('#online_dialog'));
            main_dlg.show("Error", "");
            return false;
        });
        $('#skype-start-online').click(function(e) {
            e.preventDefault();
            if(main_dlg)main_dlg.hide();
            var dialog = new Dialog('#skype-dialog-online');
            dialog.showOverlay();
            dialog.$ei.fadeIn(200);
            $('#create-skype-online').click(function() {
              var participants = $("span[id='skype-online-name']").text().split(/, ?/);;
              var topic = $("input[name='skype-topic-online']").val();
              var skype_params = {
                name: "call",
                element: "SkypeButton_Call_" + participants[0] + "_1",
                participants: participants,
                imageSize: 24,
                imageColor: "skype",
                video: "true",
                topic: topic
              };
              $('.skype-container-online').attr('id', "SkypeButton_Call_" + participants[0] + "_1");
              startSkypeOnline(skype_params);
            });
          });
    });

</script>

