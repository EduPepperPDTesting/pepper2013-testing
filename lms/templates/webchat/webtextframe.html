<%!
   from django.core.urlresolvers import reverse
%>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<div class="pep_text_panel container">
    <div class="pep_textchatheader_container">
        <div class="pep_textchatheader_title">
            <span class="pep_header_left" id="${user_class}">${user_name}</span>
        </div>
        <div class="pep_header_right">
            <a href="#">+</a>
            <a href="#" class="pep_start_video" id="${user_id}">
                <img src="https://image.flaticon.com/icons/svg/345/345686.svg" alt="im-video"
                     style="width:15px;height:15px;border:0">
            </a>
            <span class="close-chat"> &#10005;</span>
        </div>
    </div>
    <div class="pep_text_chat" id="textchat_${user_id}"></div>
    <div class="pep_textchatfooter_container container-fluid">
        <div class="row">
            <input type="text" class="pep_chat_input col-sm-8" data-to_id="${user_id}" data-from_id="${request.user.id}"></input>
            <div class="pep_chat_icons col-sm-3">
                <a href="#"><img src="/static/images/Pepptalk/PeppText.png" alt="im-text"></a>
                <div class="pep-image-upload" style="display: inline-block;">
                    <form action="${reverse('chat_attachment', args=[request.user.id, user_id])}" method="post" enctype="multipart/form-data" id="pep_attachment_form">
                        <label id="input_label_${user_id}" for="pep_file_input" style="display: inline-block;">
                            <img src="/static/images/Pepptalk/PeppAttachment.png" alt="im-video">
                        </label>
                        <input id="pep_file_input" type="file" name='attachment' style="display: none;"/>
                        <input type="hidden" name="csrfmiddlewaretoken" value="${csrf_token}"/>
                        <label id="submit_label_${user_id}" for="pep_file_submit" style="display: none;">
                            <img src="/static/images/Pepptalk/PeppAttachment.png" alt="im-video" onclick="hideSubmit(${user_id})">
                        </label>
                        <input  id="pep_file_submit" type="submit" name="submit" style="display: none;">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
         console.log("show "+${user_id});
        $("#input_label_"+${user_id}).next("input").on("change", function(){
            console.log("showSubmit "+${user_id});
            $("#input_label_"+${user_id}).css("display", "none");
            $("#submit_label_"+${user_id}).css("display", "inline-block");
        });
        $("#submit_label_"+${user_id}).on("click", "img", function(){
            console.log("hideSubmit "+${user_id});
            $("#submit_label_"+${user_id}).css("display", "none");
            $("#input_label_"+${user_id}).css("display", "inline-block");
        });
    });
</script>